/*!
 *     ____  __  ______  __________ _    _____________       ____________ 
 *    / __ \/ / / / __ \/_  __/ __ \ |  / /  _/ ____/ |     / / ____/ __ \
 *   / /_/ / /_/ / / / / / / / / / / | / // // __/  | | /| / / __/ / /_/ /
 *  / ____/ __  / /_/ / / / / /_/ /| |/ // // /___  | |/ |/ / /___/ _, _/
 * /_/   /_/ /_/\____/ /_/  \____/ |___/___/_____/  |__/|__/_____/_/ |_|                                                            
 *
 * photoviewer - v3.4.0
 * A JS plugin to view images just like in Windows
 * https://nzbin.github.io/photoviewer/
 *
 * Copyright (c) 2018 nzbin
 * Released under MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).photoviewer=e()}(this,function(){"use strict";var t=function(e,i){return new t.fn.init(e,i)},e=window.document,i=[],o=i.concat,n=i.filter,s=i.slice,a={},h={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},r=/^\s*<(\w+|!)[^>]*>/,l=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,c=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,d=/^(?:body|html)$/i,u=["val","css","html","text","data","width","height","offset"],f=e.createElement("table"),p=e.createElement("tr"),g={tr:e.createElement("tbody"),tbody:f,thead:f,tfoot:f,td:p,th:p,"*":e.createElement("div")},m=/^[\w-]*$/,v={},w=v.toString,x=e.createElement("div"),b=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},y=e.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1};function z(t){return null==t?String(t):v[w.call(t)]||"object"}function $(t){return"function"==z(t)}function M(t){return null!=t&&t==t.window}function T(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function C(t){return"object"==z(t)}function L(t){return C(t)&&!M(t)&&Object.getPrototypeOf(t)==Object.prototype}function H(t){var e=!!t&&"length"in t&&t.length,i=z(t);return"function"!=i&&!M(t)&&("array"==i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function D(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function V(t,e){return"number"!=typeof e||h[D(t)]?e:e+"px"}function I(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function E(t){return t in a?a[t]:a[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function R(e){return e instanceof t}function S(t,e,i,o){return $(e)?e.call(t,i,o):e}function A(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function k(t,e){var i=t.className||"",o=i&&void 0!==i.baseVal;if(void 0===e)return o?i.baseVal:i;o?i.baseVal=e:t.className=e}function O(e,i){var o=e.replace(/./,function(t){return t[0].toUpperCase()}),n=this[0];return void 0===i?M(n)?n["inner"+o]:T(n)?n.documentElement["scroll"+o]:function(t,e){return"border-box"===t.css("box-sizing")?"width"===e?parseFloat(t.css(e))-parseFloat(t.css("padding-left"))-parseFloat(t.css("padding-right"))-parseFloat(t.css("border-left-width"))-parseFloat(t.css("border-right-width")):parseFloat(t.css(e))-parseFloat(t.css("padding-top"))-parseFloat(t.css("padding-bottom"))-parseFloat(t.css("border-top-width"))-parseFloat(t.css("border-bottom-width")):parseFloat(t.css(e))}(this,e):this.each(function(o){(n=t(this)).css(e,S(this,i,o,n[e]()))})}t.fn=t.prototype={constuctor:t,length:0,forEach:i.forEach,reduce:i.reduce,push:i.push,sort:i.sort,splice:i.splice,indexOf:i.indexOf,init:function(i,o){var s,a;if(!i)return this;if("string"==typeof i)if("<"==(i=i.trim())[0]&&r.test(i))s=t.fragment(i,RegExp.$1,o),i=null;else{if(void 0!==o)return t(o).find(i);s=t.qsa(e,i)}else{if($(i))return t(e).ready(i);if(R(i))return i;if(b(i))a=i,s=n.call(a,function(t){return null!=t});else if(C(i))s=[i],i=null;else{if(void 0!==o)return t(o).find(i);s=t.qsa(e,i)}}return t.makeArray(s,i,this)},concat:function(){var t,e,i=[];for(t=0;t<arguments.length;t++)e=arguments[t],i[t]=R(e)?e.toArray():e;return o.apply(R(this)?this.toArray():this,i)},pluck:function(e){return t.map(this,function(t){return t[e]})},toArray:function(){return this.get()},get:function(t){return void 0===t?s.call(this):this[t>=0?t:t+this.length]},size:function(){return this.length},each:function(t){return i.every.call(this,function(e,i){return!1!==t.call(e,i,e)}),this},map:function(e){return t(t.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return t(s.apply(this,arguments))},first:function(){var e=this[0];return e&&!C(e)?e:t(e)},last:function(){var e=this[this.length-1];return e&&!C(e)?e:t(e)},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)}},t.extend=t.fn.extend=function(){var e,i,o,n,s,a,h=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof h&&(c=h,h=arguments[r]||{},r++),"object"==typeof h||$(h)||(h={}),r===l&&(h=this,r--);r<l;r++)if(null!=(e=arguments[r]))for(i in e)o=h[i],h!==(n=e[i])&&(c&&n&&(L(n)||(s=b(n)))?(s?(s=!1,a=o&&b(o)?o:[]):a=o&&L(o)?o:{},h[i]=t.extend(c,a,n)):void 0!==n&&(h[i]=n));return h},t.extend({makeArray:function(t,e,i){var o,n=t?t.length:0;for(o=0;o<n;o++)i[o]=t[o];return i.length=n,i.selector=e||"",i},qsa:function(t,e){var i,o="#"==e[0],n=!o&&"."==e[0],a=o||n?e.slice(1):e,h=m.test(a);return t.getElementById&&h&&o?(i=t.getElementById(a))?[i]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:s.call(h&&!o&&t.getElementsByClassName?n?t.getElementsByClassName(a):t.getElementsByTagName(e):t.querySelectorAll(e))},fragment:function(i,o,n){var a,h,d;return l.test(i)&&(a=t(e.createElement(RegExp.$1))),a||(i.replace&&(i=i.replace(c,"<$1></$2>")),void 0===o&&(o=r.test(i)&&RegExp.$1),o in g||(o="*"),(d=g[o]).innerHTML=""+i,a=t.each(s.call(d.childNodes),function(){d.removeChild(this)})),L(n)&&(h=t(a),t.each(n,function(t,e){u.indexOf(t)>-1?h[t](e):h.attr(t,e)})),a},matches:function(e,i){if(!i||!e||1!==e.nodeType)return!1;var o=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(o)return o.call(e,i);var n,s=e.parentNode,a=!s;return a&&(s=x).appendChild(e),n=~t.qsa(s,i).indexOf(e),a&&x.removeChild(e),n},each:function(t,e){var i,o;if(H(t)){for(i=0;i<t.length;i++)if(!1===e.call(t[i],i,t[i]))return t}else for(o in t)if(!1===e.call(t[o],o,t[o]))return t;return t},map:function(e,i){var o,n,s,a,h=[];if(H(e))for(n=0;n<e.length;n++)null!=(o=i(e[n],n))&&h.push(o);else for(s in e)null!=(o=i(e[s],s))&&h.push(o);return(a=h).length>0?t.fn.concat.apply([],a):a}}),t.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){v["[object "+e+"]"]=e.toLowerCase()}),t.fn.init.prototype=t.fn;var F=function(t,e){e(t);for(var i=0,o=t.childNodes.length;i<o;i++)F(t.childNodes[i],e)},P=function(i,o,n,s){var a,h,r=t.map(o,function(e){var i=[];return"array"==(a=z(e))?(e.forEach(function(e){return void 0!==e.nodeType?i.push(e):R(e)?i=i.concat(e.get()):void(i=i.concat(t.fragment(e)))}),i):"object"==a||null==e?e:t.fragment(e)}),l=i.length>1;return r.length<1?i:i.each(function(i,o){h=s?o:o.parentNode;var a=y(e.documentElement,h);r.forEach(function(e){if(l)e=e.cloneNode(!0);else if(!h)return t(e).remove();n.call(o,e),a&&F(e,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var e=t.ownerDocument?t.ownerDocument.defaultView:window;e.eval.call(e,t.innerHTML)}})})})};var j=1;function N(t){return t._zid||(t._zid=j++)}function B(t){return"string"==typeof t}var _=function(){return!0},Y=function(){return!1},W={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function X(e,i){if(i||!e.isDefaultPrevented){i||(i=e),t.each(W,function(t,o){var n=i[t];e[t]=function(){return this[o]=_,n&&n.apply(i,arguments)},e[o]=Y});try{e.timeStamp||(e.timeStamp=Date.now())}catch(t){}(void 0!==i.defaultPrevented?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(e.isDefaultPrevented=_)}return e}var q={},Z="onfocusin"in window,K={focus:"focusin",blur:"focusout"},U={mouseenter:"mouseover",mouseleave:"mouseout"},G=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/;function J(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function Q(t,e,i,o){if((e=J(e)).ns)var n=(s=e.ns,new RegExp("(?:^| )"+s.replace(" "," .* ?")+"(?: |$)"));var s;return(q[N(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||n.test(t.ns))&&(!i||N(t.fn)===N(i))&&(!o||t.sel==o)})}function tt(t,e){return t.del&&!Z&&t.e in K||!!e}function et(t){return U[t]||Z&&K[t]||t}function it(t,e,i,o,n){var s=N(t);(e||"").split(/\s/).forEach(function(e){Q(t,e,i,o).forEach(function(e){delete q[s][e.i],"removeEventListener"in t&&t.removeEventListener(et(e.e),e.proxy,tt(e,n))})})}var ot,nt="",st=e.createElement("div"),at=st.style.transitionProperty;function ht(t){return ot?ot+t:t.toLowerCase()}void 0===st.style.transform&&t.each({Webkit:"webkit",Moz:"",O:"o"},function(t,e){if(void 0!==st.style[t+"TransitionProperty"])return nt="-"+t.toLowerCase()+"-",ot=e,!1}),st=null,t.fx={off:void 0===ot&&void 0===at,speeds:{_default:400,fast:200,slow:600},cssPrefix:nt,transitionEnd:ht("TransitionEnd"),animationEnd:ht("AnimationEnd")};var rt,lt,ct,dt,ut,ft,pt,gt,mt,vt=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,wt={};rt=nt+"transform",wt[lt=nt+"transition-property"]=wt[ct=nt+"transition-duration"]=wt[ut=nt+"transition-delay"]=wt[dt=nt+"transition-timing-function"]=wt[ft=nt+"animation-name"]=wt[pt=nt+"animation-duration"]=wt[mt=nt+"animation-delay"]=wt[gt=nt+"animation-timing-function"]="";var xt=function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=defaultDisplay(this.nodeName))})},bt=function(){return this.css("display","none")};function yt(e,i,o,n,s){"function"!=typeof i||s||(s=i,i=void 0);var a={opacity:o};return n&&(a.scale=n,e.css(t.fx.cssPrefix+"transform-origin","0 0")),e.animate(a,i,null,s)}const zt=t,$t={isArray:b,noop:function(){}},Mt={find:function(e){var o=this;return e?"object"==typeof e?t(e).filter(function(){var t=this;return i.some.call(o,function(e){return y(e,t)})}):1==this.length?t(t.qsa(this[0],e)):this.map(function(){return t.qsa(this,e)}):t()},closest:function(e,i){var o=[],n="object"==typeof e&&t(e);return this.each(function(s,a){for(;a&&!(n?n.indexOf(a)>=0:t.matches(a,e));)a=a!==i&&!T(a)&&a.parentNode;a&&o.indexOf(a)<0&&o.push(a)}),t(o)},css:function(e,i){if(arguments.length<2){var o=this[0];if("string"==typeof e){if(!o)return;return o.style[I(e)]||getComputedStyle(o,"").getPropertyValue(e)}if(b(e)){if(!o)return;var n={},s=getComputedStyle(o,"");return t.each(e,function(t,e){n[e]=o.style[I(e)]||s.getPropertyValue(e)}),n}}var a="";if("string"==z(e))i||0===i?a=D(e)+":"+V(e,i):this.each(function(){this.style.removeProperty(D(e))});else for(var h in e)e[h]||0===e[h]?a+=D(h)+":"+V(h,e[h])+";":this.each(function(){this.style.removeProperty(D(h))});return this.each(function(){this.style.cssText+=";"+a})},addClass:function(e){var i=[];return e?this.each(function(o){if("className"in this){i=[];var n=k(this);S(this,e,o,n).split(/\s+/g).forEach(function(e){t(this).hasClass(e)||i.push(e)},this),i.length&&k(this,n+(n?" ":"")+i.join(" "))}}):this},hasClass:function(t){return!!t&&i.some.call(this,function(t){return this.test(k(t))},E(t))},removeClass:function(t){var e=[];return this.each(function(i){if("className"in this){if(void 0===t)return k(this,"");e=k(this),S(this,t,i,e).split(/\s+/g).forEach(function(t){e=e.replace(E(t)," ")}),k(this,e.trim())}})},attr:function(t,e){var i;return"string"!=typeof t||1 in arguments?this.each(function(i){if(1===this.nodeType)if(C(t))for(var o in t)A(this,o,t[o]);else A(this,t,S(this,e,i,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(t))?i:void 0},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){A(this,t)},this)})},append:function(){return P(this,arguments,function(t){this.insertBefore(t,null)},!0)},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},empty:function(){return this.each(function(){this.innerHTML=""})},html:function(e){return 0 in arguments?this.each(function(i){var o=this.innerHTML;t(this).empty().append(S(this,e,i,o))}):0 in this?this[0].innerHTML:null},width:function(t){return O.call(this,"width",t)},height:function(t){return O.call(this,"height",t)},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return void 0===t?e?this[0].scrollTop:M(this[0])?this[0].pageYOffset:this[0].defaultView.pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return void 0===t?e?this[0].scrollLeft:M(this[0])?this[0].pageXOffset:this[0].defaultView.pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},offset:function(i){if(i)return this.each(function(e){var o=t(this),n=S(this,i,e,o.offset()),s=o.offsetParent().offset(),a={top:n.top-s.top,left:n.left-s.left};"static"==o.css("position")&&(a.position="relative"),o.css(a)});if(!this.length)return null;if(e.documentElement!==this[0]&&!y(e.documentElement,this[0]))return{top:0,left:0};var o=this[0].getBoundingClientRect();return{left:o.left+window.pageXOffset,top:o.top+window.pageYOffset,width:Math.round(o.width),height:Math.round(o.height)}},offsetParent:function(){return this.map(function(){for(var i=this.offsetParent||e.body;i&&!d.test(i.nodeName)&&"static"==t(i).css("position");)i=i.offsetParent;return i})},position:function(){if(this.length){var e=this[0],i=this.offsetParent(),o=this.offset(),n=d.test(i[0].nodeName)?{top:0,left:0}:i.offset();return o.top-=parseFloat(t(e).css("margin-top"))||0,o.left-=parseFloat(t(e).css("margin-left"))||0,n.top+=parseFloat(t(i[0]).css("border-top-width"))||0,n.left+=parseFloat(t(i[0]).css("border-left-width"))||0,{top:o.top-n.top,left:o.left-n.left}}},on:function(i,o,n,a,h){var r,l,c=this;return i&&!B(i)?(t.each(i,function(t,e){c.on(t,o,n,e,h)}),c):(B(o)||$(a)||!1===a||(a=n,n=o,o=void 0),void 0!==a&&!1!==n||(a=n,n=void 0),!1===a&&(a=Y),c.each(function(c,d){h&&(r=function(t){return it(d,t.type,a),a.apply(this,arguments)}),o&&(l=function(e){var i,n=t(e.target).closest(o,d).get(0);if(n&&n!==d)return i=t.extend(function(t){var e,i={originalEvent:t};for(e in t)G.test(e)||void 0===t[e]||(i[e]=t[e]);return X(i,t)}(e),{currentTarget:n,liveFired:d}),(r||a).apply(n,[i].concat(s.call(arguments,1)))}),function(i,o,n,s,a,h,r){var l=N(i),c=q[l]||(q[l]=[]);o.split(/\s/).forEach(function(o){if("ready"==o)return t(e).ready(n);var l=J(o);l.fn=n,l.sel=a,l.e in U&&(n=function(t){var e=t.relatedTarget;if(!e||e!==this&&!y(this,e))return l.fn.apply(this,arguments)}),l.del=h;var d=h||n;l.proxy=function(t){if(!(t=X(t)).isImmediatePropagationStopped()){t.data=s;var e=d.apply(i,void 0==t._args?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},l.i=c.length,c.push(l),"addEventListener"in i&&i.addEventListener(et(l.e),l.proxy,tt(l,r))})}(d,i,a,n,o,l||r)}))},off:function(e,i,o){var n=this;return e&&!B(e)?(t.each(e,function(t,e){n.off(t,i,e)}),n):(B(i)||$(o)||!1===o||(o=i,i=void 0),!1===o&&(o=Y),n.each(function(){it(this,e,o,i)}))},show:function(t,e){return xt.call(this),void 0===t?t=0:this.css("opacity",0),yt(this,t,1,"1,1",e)},hide:function(e,i){return void 0===e?bt.call(this):function(e,i,o,n){return yt(e,i,0,o,function(){bt.call(t(this)),n&&n.call(this)})}(this,e,"0,0",i)},anim:function(e,i,o,n,s){var a,h,r,l={},c="",d=this,u=t.fx.transitionEnd,f=!1;if(void 0===i&&(i=t.fx.speeds._default/1e3),void 0===s&&(s=0),t.fx.off&&(i=0),"string"==typeof e)l[ft]=e,l[pt]=i+"s",l[mt]=s+"s",l[gt]=o||"linear",u=t.fx.animationEnd;else{for(a in h=[],e)vt.test(a)?c+=a+"("+e[a]+") ":(l[a]=e[a],h.push(a.replace(/([A-Z])/g,"-$1").toLowerCase()));c&&(l[rt]=c,h.push(rt)),i>0&&"object"==typeof e&&(l[lt]=h.join(", "),l[ct]=i+"s",l[ut]=s+"s",l[dt]=o||"linear")}return r=function(e){if(void 0!==e){if(e.target!==e.currentTarget)return;t(e.target).off(u,r)}else t(this).off(u,r);f=!0,t(this).css(wt),n&&n.call(this)},i>0&&(this.on(u,r),setTimeout(function(){f||r.call(d)},1e3*(i+s)+25)),this.size()&&this.get(0).clientLeft,this.css(l),i<=0&&setTimeout(function(){d.each(function(){r.call(this)})},0),this},animate:function(e,i,o,n,s){return $(i)&&(n=i,o=void 0,i=void 0),$(o)&&(n=o,o=void 0),L(i)&&(o=i.easing,n=i.complete,s=i.delay,i=i.duration),i&&(i=("number"==typeof i?i:t.fx.speeds[i]||t.fx.speeds._default)/1e3),s&&(s=parseFloat(s)/1e3),this.anim(e,i,o,n,s)},fadeTo:function(t,e,i){return yt(this,t,e,null,i)},fadeIn:function(t,e){var i=this.css("opacity");return i>0?this.css("opacity",0):i=1,xt.call(this).fadeTo(t,i,e)}};zt.extend($t),zt.fn.extend(Mt);var Tt={draggable:!0,resizable:!0,movable:!0,keyboard:!0,title:!0,modalWidth:320,modalHeight:320,fixedContent:!0,fixedModalSize:!1,initMaximized:!1,gapThreshold:.02,ratioThreshold:.1,minRatio:.05,maxRatio:16,headToolbar:["maximize","close"],footToolbar:["zoomIn","zoomOut","prev","fullscreen","next","actualSize","rotateRight"],icons:{minimize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M20,14H4V10H20"></path>\n      </svg>',maximize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M4,4H20V20H4V4M6,8V18H18V8H6Z"></path>\n      </svg>',close:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12\n        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z"></path>\n      </svg>',zoomIn:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\n        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5\n        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5\n        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z"></path>\n      </svg>',zoomOut:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5\n        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16\n        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14\n        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z"></path>\n      </svg>',prev:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"></path>\n      </svg>',next:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z"></path>\n      </svg>',fullscreen:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3\n        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z"></path>\n      </svg>',actualSize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09\n        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19\n        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\n        L13.09,9.5Z"></path>\n      </svg>',rotateLeft:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12\n        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07\n        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32\n        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13\n        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z"></path>\n      </svg>',rotateRight:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91\n        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31\n        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11\n        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12\n        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10\n        L15.55,5.55Z"></path>\n      </svg>'},i18n:{minimize:"minimize",maximize:"maximize",close:"close",zoomIn:"zoom-in(+)",zoomOut:"zoom-out(-)",prev:"prev(←)",next:"next(→)",fullscreen:"fullscreen",actualSize:"actual-size(Ctrl+Alt+0)",rotateLeft:"rotate-left(Ctrl+,)",rotateRight:"rotate-right(Ctrl+.)"},multiInstances:!0,initAnimation:!0,fixedModalPos:!1,zIndex:1090,dragHandle:!1,callbacks:{beforeOpen:zt.noop,opened:zt.noop,beforeClose:zt.noop,closed:zt.noop,beforeChange:zt.noop,changed:zt.noop},index:0,progressiveLoading:!0,appendTo:"body"};const Ct=window.document;function Lt(t,e,i,o){const n=o?t.h:t.w,s=o?t.w:t.h;(s>e.h||n>e.w)&&i.addClass("is-grab"),s<=e.h&&n<=e.w&&i.removeClass("is-grab")}function Ht(){return!!("ontouchstart"in window||window.DocumentTouch&&Ct instanceof window.DocumentTouch)}const Dt=zt(window),Vt=zt(Ct),It="click",Et="resize",Rt="keydown",St="wheel mousewheel DOMMouseScroll",At=Ht()?"touchstart":"mousedown",kt=Ht()?"touchmove":"mousemove",Ot=Ht()?"touchend":"mouseup",Ft="photoviewer",Pt="."+Ft,jt="."+Ft,Nt={isMoving:!1,isResizing:!1,zIndex:0};var Bt={draggable(t,e,i){let o=!1,n=0,s=0,a=0,h=0;const r=e=>{if((e=e||window.event).preventDefault(),o&&!Nt.isMoving&&!Nt.isResizing&&!this.isMaximized){const i="touchmove"===e.type?e.targetTouches[0].pageX:e.clientX,o="touchmove"===e.type?e.targetTouches[0].pageY:e.clientY,r=i-n,l=o-s;zt(t).css({left:r+a+"px",top:l+h+"px"})}},l=()=>{Vt.off(kt+jt,r).off(Ot+jt,l),o=!1};zt(e).on(At+jt,e=>{if(e=e||window.event,zt(e.target).closest(i).length)return!0;this.options.multiInstances&&t.css("z-index",++Nt.zIndex),o=!0,n="touchstart"===e.type?e.targetTouches[0].pageX:e.clientX,s="touchstart"===e.type?e.targetTouches[0].pageY:e.clientY,a=zt(t).offset().left,h=zt(t).offset().top,Vt.on(kt+jt,r).on(Ot+jt,l)})}};const _t="html, body, ."+Ft+"-modal, ."+Ft+"-stage, ."+Ft+"-button, ."+Ft+"-resizable-handle";var Yt={movable(t,e){let i=!1,o=0,n=0,s=0,a=0,h=0,r=0,l=0;const c=t=>{if((t=t||window.event).preventDefault(),i){const i="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,c="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,d=i-o,u=c-n;let f=d+s,p=u+a;r>0?u+a>l?p=l:u+a<-r+l&&(p=-r+l):p=a,h>0?d+s>-l?f=-l:d+s<-h-l&&(f=-h-l):f=s,zt(e).css({left:f+"px",top:p+"px"}),zt.extend(this.imageData,{left:f,top:p})}},d=()=>{Vt.off(kt+jt,c).off(Ot+jt,d),i=!1,Nt.isMoving=!1,zt(_t).removeClass("is-grabbing")};zt(t).on(At+jt,u=>{(u=u||window.event).preventDefault();const f=zt(e).width(),p=zt(e).height(),g=zt(t).width(),m=zt(t).height();o="touchstart"===u.type?u.targetTouches[0].pageX:u.clientX,n="touchstart"===u.type?u.targetTouches[0].pageY:u.clientY,l=this.isRotated?(f-p)/2:0,h=this.isRotated?p-g:f-g,r=this.isRotated?f-m:p-m,i=h>0||r>0,Nt.isMoving=h>0||r>0,s=zt(e).position().left-l,a=zt(e).position().top+l,t.hasClass("is-grab")&&zt(_t).addClass("is-grabbing"),Vt.on(kt+jt,c).on(Ot+jt,d)})}};const Wt="html, body, ."+Ft+"-modal, ."+Ft+"-stage, ."+Ft+"-button";var Xt={resizable(t,e,i,o,n){const s=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-e"></div>'),a=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-w"></div>'),h=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-s"></div>'),r=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-n"></div>'),l=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-se"></div>'),c=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-sw"></div>'),d=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-ne"></div>'),u=zt('<div class="'+Ft+"-resizable-handle "+Ft+'-resizable-handle-nw"></div>'),f={e:s,s:h,se:l,n:r,w:a,nw:u,ne:d,sw:c};zt(t).append(s,a,h,r,l,c,d,u);let p=!1,g=0,m=0,v={w:0,h:0,l:0,t:0},w={w:0,h:0,l:0,t:0},x={w:0,h:0,l:0,t:0},b=0,y=0,z=0,$="";const M=(o,n)=>{(n=n||window.event).preventDefault(),p=!0,Nt.isResizing=!0,g="touchstart"===n.type?n.targetTouches[0].pageX:n.clientX,m="touchstart"===n.type?n.targetTouches[0].pageY:n.clientY,v={w:zt(t).width(),h:zt(t).height(),l:zt(t).offset().left,t:zt(t).offset().top},w={w:zt(e).width(),h:zt(e).height(),l:zt(e).offset().left,t:zt(e).offset().top},x={w:zt(i).width(),h:zt(i).height(),l:zt(i).position().left,t:zt(i).position().top},b=this.isRotated?(x.w-x.h)/2:0,y=this.isRotated?x.h:x.w,z=this.isRotated?x.w:x.h,$=o,zt(Wt).css("cursor",o+"-resize"),Vt.on(kt+jt,T).on(Ot+jt,C)},T=e=>{if((e=e||window.event).preventDefault(),p&&!this.isMaximized){const s="touchmove"===e.type?e.targetTouches[0].pageX:e.clientX,a="touchmove"===e.type?e.targetTouches[0].pageY:e.clientY,h=s-g,r=a-m,l=function(t,e,i){const s=-e+v.w>o?e+v.l:v.l+v.w-o,a=-i+v.h>n?i+v.t:v.t+v.h-n;return{e:{width:Math.max(e+v.w,o)+"px"},s:{height:Math.max(i+v.h,n)+"px"},se:{width:Math.max(e+v.w,o)+"px",height:Math.max(i+v.h,n)+"px"},w:{width:Math.max(-e+v.w,o)+"px",left:s+"px"},n:{height:Math.max(-i+v.h,n)+"px",top:a+"px"},nw:{width:Math.max(-e+v.w,o)+"px",height:Math.max(-i+v.h,n)+"px",top:a+"px",left:s+"px"},ne:{width:Math.max(e+v.w,o)+"px",height:Math.max(-i+v.h,n)+"px",top:a+"px"},sw:{width:Math.max(-e+v.w,o)+"px",height:Math.max(i+v.h,n)+"px",left:s+"px"}}[t]}($,h,r);zt(t).css(l);const c=function(t,e,s){const a=e+v.w>o?w.w-y+e-b:o-(v.w-w.w)-y-b,h=s+v.h>n?w.h-z+s+b:n-(v.h-w.h)-z+b,r=-e+v.w>o?w.w-y-e-b:o-(v.w-w.w)-y-b,l=-s+v.h>n?w.h-z-s+b:n-(v.h-w.h)-z+b,c=(a>0?zt(i).position().left:zt(i).position().left<0?zt(i).position().left:0)-b,d=(h>0?zt(i).position().top:zt(i).position().top<0?zt(i).position().top:0)+b,u=(r>0?zt(i).position().left:zt(i).position().left<0?zt(i).position().left:0)-b,f=(l>0?zt(i).position().top:zt(i).position().top<0?zt(i).position().top:0)+b;return{e:{left:a>=-b?(a-b)/2+"px":c>a?c+"px":a+"px"},s:{top:h>=b?(h+b)/2+"px":d>h?d+"px":h+"px"},se:{top:h>=b?(h+b)/2+"px":d>h?d+"px":h+"px",left:a>=-b?(a-b)/2+"px":c>a?c+"px":a+"px"},w:{left:r>=-b?(r-b)/2+"px":u>r?u+"px":r+"px"},n:{top:l>=b?(l+b)/2+"px":f>l?f+"px":l+"px"},nw:{top:l>=b?(l+b)/2+"px":f>l?f+"px":l+"px",left:r>=-b?(r-b)/2+"px":u>r?u+"px":r+"px"},ne:{top:l>=b?(l+b)/2+"px":f>l?f+"px":l+"px",left:a>=-b?(a-b)/2+"px":c>a?c+"px":a+"px"},sw:{top:h>=b?(h+b)/2+"px":d>h?d+"px":h+"px",left:r>=-b?(r-b)/2+"px":u>r?u+"px":r+"px"}}[t]}($,h,r);zt(i).css(c),this.isDoResize=!0}},C=()=>{Vt.off(kt+jt,T).off(Ot+jt,C),Nt.isResizing&&Lt({w:y,h:z},{w:zt(e).width(),h:zt(e).height()},e),p=!1,Nt.isResizing=!1,zt(Wt).css("cursor","");const t=this.getImageScaleToStage(zt(e).width(),zt(e).height());zt.extend(this.imageData,{initWidth:this.img.width*t,initHeight:this.img.height*t,initLeft:(zt(e).width()-this.img.width*t)/2,initTop:(zt(e).height()-this.img.height*t)/2})};zt.each(f,function(t,e){e.on(At+jt,function(e){M(t,e)})})}};class qt{constructor(t,e,i){this.options=zt.extend(!0,{},Tt,e),e&&zt.isArray(e.footToolbar)&&(this.options.footToolbar=e.footToolbar),e&&zt.isArray(e.headToolbar)&&(this.options.headToolbar=e.headToolbar),this.$el=zt(i),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0,this.isDoResize=!1,this.imageData={},this.modalData={width:null,height:null,left:null,top:null},this.init(t,this.options)}init(t,e){this.groupData=t,this.groupIndex=e.index,Nt.zIndex=0===Nt.zIndex?e.zIndex:Nt.zIndex;const i=t[this.groupIndex].src;this.open(),this.loadImg(i),e.draggable&&this.draggable(this.$photoviewer,this.dragHandle,Pt+"-button"),e.movable&&this.movable(this.$stage,this.$image),e.resizable&&this.resizable(this.$photoviewer,this.$stage,this.$image,e.modalWidth,e.modalHeight)}_createBtns(t,e){let i="";return zt.each(t,function(t,o){i+=e[o]}),i}_createTitle(){return this.options.title?'<div class="'+Ft+'-title"></div>':""}render(){const t={minimize:'<button class="'+Ft+"-button "+Ft+'-button-minimize" title="'+this.options.i18n.minimize+'">\n          '+this.options.icons.minimize+"\n        </button>",maximize:'<button class="'+Ft+"-button "+Ft+'-button-maximize" title="'+this.options.i18n.maximize+'">\n          '+this.options.icons.maximize+"\n        </button>",close:'<button class="'+Ft+"-button "+Ft+'-button-close" title="'+this.options.i18n.close+'">\n          '+this.options.icons.close+"\n        </button>",zoomIn:'<button class="'+Ft+"-button "+Ft+'-button-zoom-in" title="'+this.options.i18n.zoomIn+'">\n          '+this.options.icons.zoomIn+"\n        </button>",zoomOut:'<button class="'+Ft+"-button "+Ft+'-button-zoom-out" title="'+this.options.i18n.zoomOut+'">\n          '+this.options.icons.zoomOut+"\n        </button>",prev:'<button class="'+Ft+"-button "+Ft+'-button-prev" title="'+this.options.i18n.prev+'">\n          '+this.options.icons.prev+"\n        </button>",next:'<button class="'+Ft+"-button "+Ft+'-button-next" title="'+this.options.i18n.next+'">\n          '+this.options.icons.next+"\n        </button>",fullscreen:'<button class="'+Ft+"-button "+Ft+'-button-fullscreen" title="'+this.options.i18n.fullscreen+'">\n          '+this.options.icons.fullscreen+"\n        </button>",actualSize:'<button class="'+Ft+"-button "+Ft+'-button-actual-size" title="'+this.options.i18n.actualSize+'">\n          '+this.options.icons.actualSize+"\n        </button>",rotateLeft:'<button class="'+Ft+"-button "+Ft+'-button-rotate-left" title="'+this.options.i18n.rotateLeft+'">\n          '+this.options.icons.rotateLeft+"\n        </button>",rotateRight:'<button class="'+Ft+"-button "+Ft+'-button-rotate-right" title="'+this.options.i18n.rotateRight+'">\n          '+this.options.icons.rotateRight+"\n        </button>"};return'<div class="'+Ft+'-modal">\n        <div class="'+Ft+'-inner">\n          <div class="'+Ft+'-header">\n            <div class="'+Ft+"-toolbar "+Ft+'-toolbar-head">\n              '+this._createBtns(this.options.headToolbar,t)+"\n            </div>\n            "+this._createTitle()+'\n          </div>\n          <div class="'+Ft+'-stage">\n            <img class="'+Ft+'-image" src="" alt="" />\n          </div>\n          <div class="'+Ft+'-footer">\n            <div class="'+Ft+"-toolbar "+Ft+'-toolbar-foot">\n              '+this._createBtns(this.options.footToolbar,t)+"\n            </div>\n          </div>\n        </div>\n      </div>"}build(){const t=this.render(),e=zt(t);this.$photoviewer=e,this.$header=e.find(Pt+"-header"),this.$headToolbar=e.find(Pt+"-toolbar-head"),this.$footer=e.find(Pt+"-footer"),this.$footToolbar=e.find(Pt+"-toolbar-foot"),this.$stage=e.find(Pt+"-stage"),this.$title=e.find(Pt+"-title"),this.$image=e.find(Pt+"-image"),this.$close=e.find(Pt+"-button-close"),this.$maximize=e.find(Pt+"-button-maximize"),this.$minimize=e.find(Pt+"-button-minimize"),this.$zoomIn=e.find(Pt+"-button-zoom-in"),this.$zoomOut=e.find(Pt+"-button-zoom-out"),this.$actualSize=e.find(Pt+"-button-actual-size"),this.$fullscreen=e.find(Pt+"-button-fullscreen"),this.$rotateLeft=e.find(Pt+"-button-rotate-left"),this.$rotateRight=e.find(Pt+"-button-rotate-right"),this.$prev=e.find(Pt+"-button-prev"),this.$next=e.find(Pt+"-button-next"),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.$photoviewer.css("z-index",Nt.zIndex),this.options.dragHandle&&this.options.dragHandle!==Pt+"-modal"?this.dragHandle=this.$photoviewer.find(this.options.dragHandle):this.dragHandle=this.$photoviewer}open(){if(this.options.multiInstances||zt(Pt+"-modal").eq(0).remove(),!zt(Pt+"-modal").length&&this.options.fixedContent&&(zt("html").css({overflow:"hidden"}),Ct.body.scrollHeight>(window.innerHeight||Ct.documentElement.clientHeight))){let t=function(){const t=Ct.createElement("div");t.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",Ct.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return Ct.body.removeChild(t),e}();t&&zt("html").css({"padding-right":t})}this.build(),this._triggerHook("beforeOpen",this.$el),zt(this.options.appendTo).eq(0).append(this.$photoviewer),this.addEvents(),this.setModalPos(this.$photoviewer),this._triggerHook("opened",this.$el)}close(){this._triggerHook("beforeClose",this.$el),this.$photoviewer.remove(),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0;const t=!zt(Pt+"-modal").length;t&&this.options.fixedContent&&zt("html").css({overflow:"","padding-right":""}),t&&this.options.multiInstances&&(Nt.zIndex=this.options.zIndex),zt(Pt+"-modal").length||(Vt.off(Rt+jt),Dt.off(Et+jt)),this._triggerHook("closed",this.$el)}setModalPos(t){const e=Dt.width(),i=Dt.height(),o=Vt.scrollLeft(),n=Vt.scrollTop(),s=this.options.modalWidth,a=this.options.modalHeight;this.options.initMaximized?(t.addClass(Ft+"-maximize"),t.css({width:"100%",height:"100%",left:0,top:0}),this.isOpened=!0,this.isMaximized=!0):t.css({width:s,height:a,left:(e-s)/2+o+"px",top:(i-a)/2+n+"px"})}setModalSize(t){const e=Dt.width(),i=Dt.height(),o=Vt.scrollLeft(),n=Vt.scrollTop(),s={left:this.$stage.css("left"),right:this.$stage.css("right"),top:this.$stage.css("top"),bottom:this.$stage.css("bottom"),borderLeft:this.$stage.css("border-left-width"),borderRight:this.$stage.css("border-right-width"),borderTop:this.$stage.css("border-top-width"),borderBottom:this.$stage.css("border-bottom-width")},a=t.width+parseFloat(s.left)+parseFloat(s.right)+parseFloat(s.borderLeft)+parseFloat(s.borderRight),h=t.height+parseFloat(s.top)+parseFloat(s.bottom)+parseFloat(s.borderTop)+parseFloat(s.borderBottom),r=(this.options.gapThreshold>0?this.options.gapThreshold:0)+1,l=Math.min(e/(a*r),i/(h*r),1);let c=Math.max(a*l,this.options.modalWidth),d=Math.max(h*l,this.options.modalHeight);const u={width:(c=this.options.fixedModalSize?this.options.modalWidth:Math.round(c))+"px",height:(d=this.options.fixedModalSize?this.options.modalHeight:Math.round(d))+"px",left:(e-c)/2+o+"px",top:(i-d)/2+n+"px"};this.options.initAnimation?this.$photoviewer.animate(u,400,"ease-in-out",()=>{this.setImageSize(t)}):(this.$photoviewer.css(u),this.setImageSize(t)),this.isOpened=!0}getImageScaleToStage(t,e){let i=1;return i=this.isRotated?Math.min(t/this.img.height,e/this.img.width,1):Math.min(t/this.img.width,e/this.img.height,1)}setImageSize(t){const e={w:this.$stage.width(),h:this.$stage.height()},i=this.getImageScaleToStage(e.w,e.h);this.$image.css({width:Math.ceil(t.width*i)+"px",height:Math.ceil(t.height*i)+"px",left:(e.w-Math.ceil(t.width*i))/2+"px",top:(e.h-Math.ceil(t.height*i))/2+"px"}),zt.extend(this.imageData,{initWidth:t.width*i,initHeight:t.height*i,initLeft:(e.w-t.width*i)/2,initTop:(e.h-t.height*i)/2,width:t.width*i,height:t.height*i,left:(e.w-t.width*i)/2,top:(e.h-t.height*i)/2}),Lt({w:this.$image.width(),h:this.$image.height()},{w:this.$stage.width(),h:this.$stage.height()},this.$stage,this.isRotated),this.imgLoaded||(this.$photoviewer.find(Pt+"-loader").remove(),this.$stage.removeClass("stage-ready"),this.$image.removeClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.fadeIn(),this.imgLoaded=!0)}loadImg(t,e,i){this.$image.removeAttr("style").attr("src",""),this.isRotated=!1,this.rotateAngle=0,this.imgLoaded=!1,this.$photoviewer.append('<div class="'+Ft+'-loader"></div>'),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.hide(),this.$image.attr("src",t),function(t,e,i){const o=new Image;o.onload=function(){e(o)},o.onerror=function(){i(o)},o.src=t}(t,t=>{this.img=t,this.imageData={originalWidth:t.width,originalHeight:t.height},this.isMaximized||this.isOpened&&this.options.fixedModalPos?this.setImageSize(t):this.setModalSize(t),e&&e.call()},()=>{this.$photoviewer.find(Pt+"-loader").remove(),i&&i.call()}),this.options.title&&this.setImgTitle(t)}setImgTitle(t){const e=this.groupData[this.groupIndex].title||function(t){return t.replace(/^.*?\/*([^/?]*)\.[a-z]+(\?.+|$)/gi,"$1")}(t);this.$title.html(e)}jump(t){this._triggerHook("beforeChange",this.groupIndex),this.groupIndex=this.groupIndex+t,this.jumpTo(this.groupIndex)}jumpTo(t){(t%=this.groupData.length)>=0?t%=this.groupData.length:t<0&&(t=(this.groupData.length+t)%this.groupData.length),this.groupIndex=t,this.loadImg(this.groupData[t].src,()=>{this._triggerHook("changed",t)},()=>{this._triggerHook("changed",t)})}wheel(t){t.preventDefault();let e=1;t.deltaY?e=t.deltaY>0?1:-1:t.wheelDelta?e=-t.wheelDelta/120:t.detail&&(e=t.detail>0?1:-1);const i=-e*this.options.ratioThreshold,o={x:t.clientX-this.$stage.offset().left+Vt.scrollLeft(),y:t.clientY-this.$stage.offset().top+Vt.scrollTop()};this.zoom(i,o,t)}zoom(t,e,i){t=t<0?1/(1-t):1+t,(t=this.$image.width()/this.imageData.originalWidth*t)>this.options.maxRatio||t<this.options.minRatio||this.zoomTo(t,e,i)}zoomTo(t,e,i){const o=this.$image,n=this.$stage,s=this.imageData.width,a=this.imageData.height,h=this.imageData.left,r=this.imageData.top,l={w:n.width(),h:n.height(),x:n.offset().left,y:n.offset().top},c=this.imageData.originalWidth*t,d=this.imageData.originalHeight*t;let u=e.x-(e.x-h)/s*c,f=e.y-(e.y-r)/a*d;const p=this.isRotated?(c-d)/2:0,g=this.isRotated?d:c,m=this.isRotated?c:d,v=l.w-c,w=l.h-d;f=m<=l.h?(l.h-d)/2:f>p?p:f>w-p?f:w-p,u=g<=l.w?(l.w-c)/2:u>-p?-p:u>v+p?u:v+p,Math.abs(this.imageData.initWidth-c)<.05*this.imageData.initWidth?this.setImageSize(this.img):(o.css({width:Math.round(c)+"px",height:Math.round(d)+"px",left:Math.round(u)+"px",top:Math.round(f)+"px"}),Lt({w:Math.round(g),h:Math.round(m)},{w:l.w,h:l.h},this.$stage)),zt.extend(this.imageData,{width:c,height:d,left:u,top:f})}rotate(t){this.rotateAngle=this.rotateAngle+t,this.rotateAngle/90%2==0?this.isRotated=!1:this.isRotated=!0,this.rotateTo(this.rotateAngle)}rotateTo(t){this.$image.css({transform:"rotate("+t+"deg)"}),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}),this.$stage.removeClass("is-grab")}resize(){return function(t,e){let i=null;return function(){const o=this,n=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(o,n)},e)}}(()=>{this.isOpened&&(this.isMaximized?this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}):this.setModalSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}))},500)}maximize(){if(this.isMaximized){this.$photoviewer.removeClass(Ft+"-maximize");const t=(Dt.width()-this.options.modalWidth)/2+Vt.scrollLeft(),e=(Dt.height()-this.options.modalHeight)/2+Vt.scrollTop();this.$photoviewer.css({width:this.modalData.width?this.modalData.width:this.options.modalWidth,height:this.modalData.height?this.modalData.height:this.options.modalHeight,left:this.modalData.left?this.modalData.left:t,top:this.modalData.top?this.modalData.top:e}),this.isMaximized=!1}else this.modalData={width:this.$photoviewer.width(),height:this.$photoviewer.height(),left:this.$photoviewer.offset().left,top:this.$photoviewer.offset().top},this.$photoviewer.addClass(Ft+"-maximize"),this.$photoviewer.css({width:"100%",height:"100%",left:0,top:0}),this.isMaximized=!0;this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight})}fullscreen(){var t;(t=this.$photoviewer[0]).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}keydown(t){if(!this.options.keyboard)return!1;const e=t.keyCode||t.which||t.charCode,i=t.ctrlKey||t.metaKey,o=t.altKey||t.metaKey;switch(e){case 37:this.jump(-1);break;case 39:this.jump(1);break;case 187:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 189:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 61:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 173:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 48:i&&o&&this.zoomTo(1,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 188:i&&this.rotate(-90);break;case 190:i&&this.rotate(90);break;case 81:this.close()}}addEvents(){this.$close.off(It+jt).on(It+jt,t=>{this.close()}),this.$stage.off(St+jt).on(St+jt,t=>{this.wheel(t)}),this.$zoomIn.off(It+jt).on(It+jt,t=>{this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t)}),this.$zoomOut.off(It+jt).on(It+jt,t=>{this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t)}),this.$actualSize.off(It+jt).on(It+jt,t=>{this.zoomTo(1,{x:this.$stage.width()/2,y:this.$stage.height()/2},t)}),this.$prev.off(It+jt).on(It+jt,()=>{this.jump(-1)}),this.$fullscreen.off(It+jt).on(It+jt,()=>{this.fullscreen()}),this.$next.off(It+jt).on(It+jt,()=>{this.jump(1)}),this.$rotateLeft.off(It+jt).on(It+jt,()=>{this.rotate(-90)}),this.$rotateRight.off(It+jt).on(It+jt,()=>{this.rotate(90)}),this.$maximize.off(It+jt).on(It+jt,()=>{this.maximize()}),Vt.off(Rt+jt).on(Rt+jt,t=>{this.keydown(t)}),Dt.on(Et+jt,this.resize())}_triggerHook(t,e){this.options.callbacks[t]&&this.options.callbacks[t].apply(this,zt.isArray(e)?e:[e])}}return zt.extend(qt.prototype,Bt,Yt,Xt),window.PhotoViewer=qt,qt});